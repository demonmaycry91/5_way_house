PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE alembic_version (
	version_num VARCHAR(32) NOT NULL, 
	CONSTRAINT alembic_version_pkc PRIMARY KEY (version_num)
);
INSERT INTO alembic_version VALUES('43717958ca50');
CREATE TABLE IF NOT EXISTS "transaction" (
	id INTEGER NOT NULL, 
	timestamp DATETIME NOT NULL, 
	amount FLOAT NOT NULL, 
	item_count INTEGER NOT NULL, 
	business_day_id INTEGER NOT NULL, discounts TEXT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(business_day_id) REFERENCES business_day (id)
);
INSERT INTO "transaction" VALUES(1,'2025-08-12 06:46:23.397930',750.0,2,1,NULL);
INSERT INTO "transaction" VALUES(2,'2025-08-12 06:46:35.685009',50.0,3,1,NULL);
INSERT INTO "transaction" VALUES(3,'2025-08-12 06:46:51.718603',200.0,4,1,NULL);
INSERT INTO "transaction" VALUES(4,'2025-08-12 11:53:00.136027',5.0,1,2,NULL);
INSERT INTO "transaction" VALUES(5,'2025-08-12 11:53:07.951115',60.0,1,2,NULL);
INSERT INTO "transaction" VALUES(6,'2025-08-12 13:10:57.127043',110.0,2,2,NULL);
INSERT INTO "transaction" VALUES(7,'2025-08-12 13:11:03.414369',120.0,2,2,NULL);
INSERT INTO "transaction" VALUES(8,'2025-08-12 13:14:29.360144',100.0,2,2,NULL);
INSERT INTO "transaction" VALUES(9,'2025-08-12 13:14:43.416305',120.0,2,3,NULL);
INSERT INTO "transaction" VALUES(10,'2025-08-12 13:25:03.978878',110.0,2,2,NULL);
INSERT INTO "transaction" VALUES(11,'2025-08-12 13:45:45.691156',500.0,1,4,NULL);
INSERT INTO "transaction" VALUES(12,'2025-08-12 17:42:53.009965',110.0,2,5,NULL);
INSERT INTO "transaction" VALUES(13,'2025-08-13 06:36:41.985359',1000.0,2,6,NULL);
INSERT INTO "transaction" VALUES(14,'2025-08-13 06:39:31.733647',1000.0,2,6,NULL);
INSERT INTO "transaction" VALUES(15,'2025-08-13 06:46:32.850592',505.0,2,6,NULL);
INSERT INTO "transaction" VALUES(16,'2025-08-13 06:48:43.123892',110.0,2,6,NULL);
INSERT INTO "transaction" VALUES(17,'2025-08-13 06:52:47.865147',50.0,1,6,NULL);
INSERT INTO "transaction" VALUES(18,'2025-08-13 17:00:58.534219',210.0,3,7,NULL);
INSERT INTO "transaction" VALUES(19,'2025-08-13 17:01:43.881173',220.0,3,7,'[50]');
INSERT INTO "transaction" VALUES(20,'2025-08-13 17:02:06.060809',110.0,2,7,NULL);
INSERT INTO "transaction" VALUES(21,'2025-08-13 17:14:49.492581',90.0,2,7,'[20]');
INSERT INTO "transaction" VALUES(22,'2025-08-13 17:15:17.486576',180.0,3,7,NULL);
INSERT INTO "transaction" VALUES(23,'2025-08-13 17:15:31.495623',60.0,2,7,'[50]');
INSERT INTO "transaction" VALUES(24,'2025-08-13 17:15:47.125934',110.0,2,7,NULL);
INSERT INTO "transaction" VALUES(25,'2025-08-13 17:17:36.857364',120.0,2,7,NULL);
INSERT INTO "transaction" VALUES(26,'2025-08-13 17:17:50.765908',70.0,2,7,'[50]');
INSERT INTO "transaction" VALUES(27,'2025-08-13 17:18:03.357534',120.0,2,7,NULL);
INSERT INTO "transaction" VALUES(28,'2025-08-13 17:18:54.227425',160.0,3,7,NULL);
INSERT INTO "transaction" VALUES(29,'2025-08-13 17:19:00.722404',100.0,2,7,'[20]');
INSERT INTO "transaction" VALUES(30,'2025-08-13 17:20:13.063321',100.0,2,7,NULL);
INSERT INTO "transaction" VALUES(31,'2025-08-13 17:23:54.946507',50.0,1,7,NULL);
INSERT INTO "transaction" VALUES(32,'2025-08-13 17:32:41.196545',1380.0,19,7,NULL);
INSERT INTO "transaction" VALUES(33,'2025-08-13 17:36:08.461522',90.0,2,7,'[20]');
INSERT INTO "transaction" VALUES(34,'2025-08-13 17:36:28.305670',110.0,2,7,NULL);
INSERT INTO "transaction" VALUES(35,'2025-08-13 17:39:09.839526',120.0,2,7,NULL);
INSERT INTO "transaction" VALUES(36,'2025-08-13 17:41:37.119639',550.0,10,7,NULL);
INSERT INTO "transaction" VALUES(37,'2025-08-13 17:42:05.469149',280.0,3,7,NULL);
INSERT INTO "transaction" VALUES(38,'2025-08-13 17:42:14.959329',130.0,2,7,NULL);
INSERT INTO "transaction" VALUES(39,'2025-08-13 17:53:29.236499',210.0,3,7,NULL);
INSERT INTO "transaction" VALUES(40,'2025-08-13 17:53:43.111154',750.0,2,7,'[50]');
INSERT INTO "transaction" VALUES(41,'2025-08-13 17:54:13.862300',550.0,10,7,NULL);
INSERT INTO "transaction" VALUES(42,'2025-08-13 17:57:03.660099',200.0,1,7,NULL);
INSERT INTO "transaction" VALUES(43,'2025-08-13 17:57:56.786706',0.0,1,7,NULL);
INSERT INTO "transaction" VALUES(44,'2025-08-13 17:59:16.030103',180.0,2,7,NULL);
INSERT INTO "transaction" VALUES(45,'2025-08-13 18:04:17.563827',110.0,2,7,NULL);
INSERT INTO "transaction" VALUES(46,'2025-08-13 18:04:32.377373',120.0,2,7,NULL);
INSERT INTO "transaction" VALUES(47,'2025-08-13 18:07:58.461866',90.0,2,7,'[20]');
INSERT INTO "transaction" VALUES(48,'2025-08-13 18:08:34.358249',500.0,1,7,NULL);
INSERT INTO "transaction" VALUES(49,'2025-08-13 18:16:07.309524',500.0,1,7,NULL);
INSERT INTO "transaction" VALUES(50,'2025-08-13 18:17:19.748778',50.0,1,7,NULL);
INSERT INTO "transaction" VALUES(51,'2025-08-13 18:34:29.279200',110.0,2,7,NULL);
INSERT INTO "transaction" VALUES(52,'2025-08-13 18:35:18.680147',50.0,1,7,NULL);
INSERT INTO "transaction" VALUES(53,'2025-08-13 18:35:24.553036',5000.0,1,7,NULL);
INSERT INTO "transaction" VALUES(54,'2025-08-13 19:08:48.063498',500.0,1,7,NULL);
INSERT INTO "transaction" VALUES(55,'2025-08-13 19:16:41.085536',500.0,1,7,NULL);
INSERT INTO "transaction" VALUES(56,'2025-08-13 19:24:26.217926',50.0,1,7,NULL);
INSERT INTO "transaction" VALUES(57,'2025-08-13 19:24:40.575666',50.0,1,7,NULL);
INSERT INTO "transaction" VALUES(58,'2025-08-13 19:28:32.115343',50.0,1,7,NULL);
INSERT INTO "transaction" VALUES(59,'2025-08-13 19:29:12.678720',500.0,1,7,NULL);
INSERT INTO "transaction" VALUES(60,'2025-08-13 19:30:12.042056',100.0,2,7,NULL);
INSERT INTO "transaction" VALUES(61,'2025-08-13 19:30:20.107790',80.0,2,7,'[20]');
INSERT INTO "transaction" VALUES(62,'2025-08-14 03:33:56.245275',750.0,2,7,NULL);
INSERT INTO "transaction" VALUES(63,'2025-08-14 04:03:59.481789',1000.0,2,8,NULL);
INSERT INTO "transaction" VALUES(64,'2025-08-14 04:05:03.783190',70.0,3,8,'[20]');
CREATE TABLE IF NOT EXISTS "business_day" (
	id INTEGER NOT NULL, 
	date DATE NOT NULL, 
	location_notes VARCHAR(200), 
	status VARCHAR(20) NOT NULL, 
	opening_cash FLOAT NOT NULL, 
	total_sales FLOAT, 
	closing_cash FLOAT, 
	expected_cash FLOAT, 
	cash_diff FLOAT, 
	total_items INTEGER, 
	total_transactions INTEGER, 
	cash_breakdown TEXT, 
	updated_at DATETIME, 
	location_id INTEGER NOT NULL, signature_operator TEXT, signature_reviewer TEXT, signature_cashier TEXT, other_income FLOAT, 
	PRIMARY KEY (id), 
	CONSTRAINT fk_business_day_location_id FOREIGN KEY(location_id) REFERENCES location (id)
);
INSERT INTO business_day VALUES(1,'2025-08-12','','CLOSED',500.0,1000.0,3000.0,1500.0,1500.0,9,3,'{"1000": 3, "500": 0, "200": 0, "100": 0, "50": 0, "10": 0, "5": 0, "1": 0}','2025-08-12 06:47:12.484727',1,NULL,NULL,NULL,NULL);
INSERT INTO business_day VALUES(2,'2025-08-12','','CLOSED',500.0,505.0,500.0,1005.0,-505.0,10,6,'{"1000": 0, "500": 0, "200": 0, "100": 5, "50": 0, "10": 0, "5": 0, "1": 0}','2025-08-12 15:05:44.900808',2,NULL,NULL,NULL,NULL);
INSERT INTO business_day VALUES(3,'2025-08-12','','CLOSED',500.0,120.0,1000.0,620.0,380.0,2,1,'{"1000": 1, "500": 0, "200": 0, "100": 0, "50": 0, "10": 0, "5": 0, "1": 0}','2025-08-12 13:30:16.763898',3,NULL,NULL,NULL,NULL);
INSERT INTO business_day VALUES(4,'2025-08-12','','CLOSED',500.0,500.0,500.0,1000.0,-500.0,1,1,'{"1000": 0, "500": 1, "200": 0, "100": 0, "50": 0, "10": 0, "5": 0, "1": 0}','2025-08-12 13:51:07.904351',4,NULL,NULL,NULL,NULL);
INSERT INTO business_day VALUES(5,'2025-08-13','','CLOSED',500.0,110.0,1000.0,610.0,390.0,2,1,'{"1000": 0, "500": 0, "200": 5, "100": 0, "50": 0, "10": 0, "5": 0, "1": 0}','2025-08-13 15:22:51.133641',1,'','','',NULL);
INSERT INTO business_day VALUES(6,'2025-08-13','','CLOSED',500.0,2665.0,1000.0,3165.0,-2165.0,9,5,'{"1000": 1, "500": 0, "200": 0, "100": 0, "50": 0, "10": 0, "5": 0, "1": 0}','2025-08-13 15:23:01.767214',2,'','','',NULL);
INSERT INTO business_day VALUES(7,'2025-08-14','','CLOSED',500.0,15360.0,10000.0,15860.0,-5860.0,115,45,'{"1000": 10, "500": 0, "200": 0, "100": 0, "50": 0, "10": 0, "5": 0, "1": 0}','2025-08-14 03:36:29.415492',1,'','','',67480.0);
INSERT INTO business_day VALUES(8,'2025-08-14','','OPEN',500.0,1070.0,NULL,NULL,NULL,5,2,NULL,'2025-08-14 04:05:03.782318',2,NULL,NULL,NULL,1780.0);
CREATE TABLE roles_users (
	user_id INTEGER NOT NULL, 
	role_id INTEGER NOT NULL, 
	PRIMARY KEY (user_id, role_id), 
	FOREIGN KEY(role_id) REFERENCES role (id), 
	FOREIGN KEY(user_id) REFERENCES user (id)
);
INSERT INTO roles_users VALUES(2,2);
INSERT INTO roles_users VALUES(1,1);
INSERT INTO roles_users VALUES(4,2);
CREATE TABLE IF NOT EXISTS "location" (
	id INTEGER NOT NULL, 
	name VARCHAR(50) NOT NULL, 
	slug VARCHAR(50) NOT NULL, 
	PRIMARY KEY (id), 
	CONSTRAINT uq_location_name UNIQUE (name), 
	UNIQUE (name)
);
INSERT INTO location VALUES(1,'本舖','main-store');
INSERT INTO location VALUES(2,'瘋衣舍','feng-yi-she');
INSERT INTO location VALUES(3,'特賣會 1','event-1');
INSERT INTO location VALUES(4,'特賣會 2','event-2');
INSERT INTO location VALUES(5,'其他','other');
CREATE TABLE system_setting (
	"key" VARCHAR(50) NOT NULL, 
	value VARCHAR(200), 
	CONSTRAINT pk_system_setting PRIMARY KEY ("key")
);
INSERT INTO system_setting VALUES('drive_folder_name','Cashier_System_Reports');
INSERT INTO system_setting VALUES('sheets_filename_format','{location_name}_{year}_業績');
CREATE TABLE IF NOT EXISTS "role" (
	id INTEGER NOT NULL, 
	description VARCHAR(255), 
	name VARCHAR(64), 
	PRIMARY KEY (id), 
	CONSTRAINT uq_role_name UNIQUE (name)
);
INSERT INTO role VALUES(1,NULL,'Admin');
INSERT INTO role VALUES(2,NULL,'Cashier');
CREATE TABLE IF NOT EXISTS "user" (
	id INTEGER NOT NULL, 
	username VARCHAR(64), 
	password_hash VARCHAR(256), google_id VARCHAR(255), email VARCHAR(120), 
	PRIMARY KEY (id)
);
INSERT INTO user VALUES(1,'admin','scrypt:32768:8:1$QTJMraffiZClAzwY$38859444db5665d420a488f79d15e3dbce78c6edb09a5e2ad124a1166abbfc99bc8671b87bd3ce931605addbba6baaacceacc71372e3d8067347a4314125c428',NULL,NULL);
INSERT INTO user VALUES(2,'cashier','scrypt:32768:8:1$3Z5aGIsAOaZF3Dbb$967f5572c26ee8526c0b396a1ad7cf146e4857d7d13cef3870b3b1536a6a64f29c5bf56f91e0a2658085c1b2f0bcde7419a7d275a483a79a853dc833140227c9',NULL,NULL);
INSERT INTO user VALUES(4,'411383025',NULL,NULL,NULL);
CREATE UNIQUE INDEX ix_location_slug ON location (slug);
CREATE UNIQUE INDEX ix_user_username ON user (username);
CREATE UNIQUE INDEX ix_user_google_id ON user (google_id);
CREATE UNIQUE INDEX ix_user_email ON user (email);
COMMIT;
